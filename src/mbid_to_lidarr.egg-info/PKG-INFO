Metadata-Version: 2.4
Name: mbid_to_lidarr
Version: 0.1.0
Summary: Bulk resolve MusicBrainz artist IDs and add to Lidarr
Author: Jeron
License: MIT
Project-URL: Homepage, https://github.com/yourname/mbid_to_lidarr
Keywords: lidarr,musicbrainz,mbid,automation
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: requests>=2.31.0
Requires-Dist: python-dotenv>=1.0.1

## mbid_to_lidarr (bulk MBID resolve + Lidarr add)

A simple CLI workflow to:
- Resolve MusicBrainz Artist IDs (MBIDs) from a plain list of artist names
- Add/monitor those artists in Lidarr via its API

### Features
- One-command bulk run combining both steps
- Respects MusicBrainz rate limits with a configurable interval
- Robust Lidarr API calls with retries and backoff
- Env-first configuration with CLI overrides
- Generates outputs under `output/`: `output/mbids.txt` (resolved MBIDs) and `output/lidarr_output.txt` (Lidarr add report)

### Requirements
- Python 3.9+
- Lidarr up and reachable

### Install (package)
Install from source in editable mode (PEP 517):
```bash
python -m venv .venv && source .venv/bin/activate
pip install -e .
```

### Configure
Copy `env.example` to `.env` and fill in values:
```bash
cp env.example .env
```
Key vars:
- `LIDARR_URL`: Base URL (e.g. http://localhost:8686)
- `LIDARR_API_KEY`: Your Lidarr API key
- `ROOT_FOLDER`: Root folder path configured in Lidarr
- `MUSICBRAINZ_UA`: Your User-Agent string for MusicBrainz (include contact)

### Quickstart (one command)
If installed as a package:
```bash
mbid-to-lidarr --limit 5
```
Or without install:
```bash
python lidarr_bulk.py --mb-ua "YourTool/1.0 (email@example.com)"
```
Defaults:
- Reads `artists.txt`
- Writes `output/mbids.txt`
- Writes `output/lidarr_output.txt`

### Detailed usage
- Bulk runner:
```bash
python lidarr_bulk.py --help
```
- Resolve MBIDs only:
```bash
python get_musicbrainz_ids.py artists.txt -o mbids.txt --interval 1.0 --ua "YourTool/1.0 (you@example.com)"
```
- Add to Lidarr from an MBID list:
```bash
python lidarr_add.py --input mbids.txt --use-default-profiles --monitor all --search-missing
```

### CLI flags

#### lidarr_bulk.py
- **artists**: Input file of artist names (default: `artists.txt` or `ARTISTS_FILE`).
- **--mbids-output**: Output path for MBIDs (default: `output/mbids.txt` or `MBIDS_OUTPUT`).
- **--lidarr-root**: Lidarr root folder path (default: `ROOT_FOLDER`).
- **--lidarr-url**: Base URL for Lidarr (default: `LIDARR_URL`).
- **--api-key**: Lidarr API key (default: `LIDARR_API_KEY`).
- **--quality-profile-id**: Quality profile ID (0 = auto or defaults; see `--use-default-profiles`).
- **--metadata-profile-id**: Metadata profile ID (0 = auto or defaults).
- **--monitor**: One of `all|missing|existing|none|future|latest|first` (default: `all` or `MONITOR_OPTION`).
- **--search-missing**: If set, trigger search for missing albums after add.
- **--report**: Path for Lidarr report (default: `output/lidarr_output.txt` or `LIDARR_REPORT`).
- **--limit**: Only process first N artists (default: 0 = all).
- **--use-default-profiles**: If set, use the first/"Default" profiles returned by Lidarr.
- **--mb-interval**: Minimum seconds between MusicBrainz requests (default: `MB_REQUEST_INTERVAL_SECONDS`, 1.0).

#### get_musicbrainz_ids.py
- **input_path**: Input file of artist names (default: `artists.txt`).
- **-o/--output**: Output path (default: `output/mbids.txt`).
- **--limit**: Only process the first N artists (0 = all).
- **--append**: Append to the output file.
- **--interval**: Minimum seconds between MusicBrainz requests (default: 1.0 or `MB_REQUEST_INTERVAL_SECONDS`).

#### lidarr_add.py
- **--input**: Path to MBID list (`lidarr:<MBID>` or `<MBID>`) (default: `mbids.txt`).
- **--root**: Lidarr root folder path (default: `ROOT_FOLDER`).
- **--quality-profile-id**: Quality profile ID (0 = auto/default).
- **--metadata-profile-id**: Metadata profile ID (0 = auto/default).
- **--limit**: Only process first N entries (0 = all).
- **--dry-run**: Lookup only; do not add.
- **--report**: Path to write the run report (default: `lidarr_output.txt`).
- **--use-default-profiles**: Use first/"Default" profiles returned by Lidarr.
- **--monitor**: One of `all|missing|existing|none|future|latest|first` (default: `all`).
- **--search-missing**: Trigger search for missing albums on add.
- **--lidarr-url**: Base URL for Lidarr (default: `LIDARR_URL`).
- **--api-key**: Lidarr API key (default: `LIDARR_API_KEY`).

### Tips
- Respect MusicBrainz’ usage policy; keep the interval ≥ 1s and set a proper UA.
- If Lidarr rejects adds, confirm your root folder exists in Lidarr and your profile IDs are valid.

### Outputs
- `output/mbids.txt`: Lines of `lidarr:<MBID>`
- `output/lidarr_output.txt`: Tab-separated report with statuses and final summary

### License
MIT
